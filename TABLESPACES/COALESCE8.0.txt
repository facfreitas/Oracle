CREATE OR REPLACE PROCEDURE COALESCE_TS
IS

	CURSOR1 INTEGER;
	CURSOR2 INTEGER;
	TOT_REG INTEGER;
	NOME CHAR(30);

 
BEGIN
	CURSOR1:=DBMS_SQL.OPEN_CURSOR;
	DBMS_SQL.PARSE(CURSOR1, 'SELECT TABLESPACE_NAME FROM DBA_TABLESPACES',DBMS_SQL.NATIVE);
	DBMS_SQL.BIND_VARIABLE(CURSOR1, 'NOME');
	TOT_REG:=DBMS_SQL.EXECUTE(CURSOR1);
 	
	WHILE (TOT_REG>=0) LOOP
 	
	ALTER TABLESPACE ' || DBMS_SQL.FETCH_ROWS(NOME) || ' COALESCE';
         TOT_REG:=TOT_REG-1;
	 END LOOP;

     CLOSE JTE;

EXCEPTION
WHEN OTHERS THEN
	 
END COALESCE_TS;